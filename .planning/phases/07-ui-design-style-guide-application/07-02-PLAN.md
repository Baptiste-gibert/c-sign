---
phase: 07-ui-design-style-guide
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - frontend/src/pages/SignPage.tsx
  - frontend/src/pages/SuccessPage.tsx
  - frontend/src/components/ParticipantForm.tsx
  - frontend/src/components/SignatureCanvas.tsx
  - frontend/src/components/PublicPageLayout.tsx
autonomous: true

must_haves:
  truths:
    - "Public signing page has dark background with themed accent color"
    - "Header shows event title and date with generative gradient background"
    - "Form card uses --surface background with --border-c border"
    - "All inputs use --bg background, --text color, --accent focus ring"
    - "Signature canvas has white background with 2px accent border"
    - "Success page shows animated checkmark with --success color"
    - "Typography follows Inter font scale (h1: 30px, body: 13px, label: 10px)"
    - "Form layout is 2-col desktop (nom/prenom, ville/n-pro), 1-col mobile"
    - "Max content width is 640px"
  artifacts:
    - path: "frontend/src/components/PublicPageLayout.tsx"
      provides: "Shared wrapper for public pages with header gradient and theme injection"
      exports: ["PublicPageLayout"]
    - path: "frontend/src/pages/SignPage.tsx"
      provides: "Themed signing page wrapped in PublicPageLayout"
      contains: "ThemeProvider"
    - path: "frontend/src/pages/SuccessPage.tsx"
      provides: "Themed success page with animated checkmark"
      contains: "ThemeProvider"
    - path: "frontend/src/components/ParticipantForm.tsx"
      provides: "Dark-themed form with design system spacing and typography"
      contains: "--accent"
    - path: "frontend/src/components/SignatureCanvas.tsx"
      provides: "Signature canvas with white bg, accent border, crosshair cursor"
      contains: "crosshair"
  key_links:
    - from: "frontend/src/pages/SignPage.tsx"
      to: "frontend/src/contexts/ThemeContext.tsx"
      via: "wraps content in ThemeProvider with event theme data"
      pattern: "ThemeProvider.*themeId|customAccent"
    - from: "frontend/src/components/PublicPageLayout.tsx"
      to: "frontend/src/config/themes.ts"
      via: "uses theme for header gradient background"
      pattern: "headerBg|useTheme"
    - from: "frontend/src/pages/SignPage.tsx"
      to: "event.theme"
      via: "reads theme from fetched event data"
      pattern: "theme"
---

<objective>
Restyle all public-facing pages (SignPage, SuccessPage, ParticipantForm, SignatureCanvas) with the C-SIGN Design System v2.0: dark-mode backgrounds, themed accent colors, Inter typography scale, responsive 2-col/1-col grid, header with generative gradient, and microinteractions.

Purpose: Transform the plain white public signing experience into a polished dark-mode themed experience per the design system specification.
Output: Fully styled public pages that consume the event's theme via ThemeProvider.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-ui-design-style-guide-application/07-01-SUMMARY.md
@.claude/documentation/design-sytem-description.md
@frontend/src/pages/SignPage.tsx
@frontend/src/pages/SuccessPage.tsx
@frontend/src/components/ParticipantForm.tsx
@frontend/src/components/SignatureCanvas.tsx
@frontend/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: PublicPageLayout wrapper with header gradient and themed structure</name>
  <files>frontend/src/components/PublicPageLayout.tsx</files>
  <action>
Create `frontend/src/components/PublicPageLayout.tsx` — a shared layout wrapper for all public pages. This component:

1. **Imports** `useTheme` from `@/contexts/ThemeContext`

2. **Structure** (matches design system section 8 wireframe):
   ```
   <div> (full page, min-h-screen, bg var(--bg), color var(--text))
     <header> (generative gradient background)
       <div> (max-w-[640px] mx-auto px-4)
         <div> (flex justify-between items-center)
           <div> (logo area)
             "C-SIGN" text (font-bold, text-sm, tracking-widest, uppercase, color var(--accent))
           </div>
           {headerRight slot — for LanguageSwitcher}
         </div>
         {eventTitle && <h1> (30px, font-bold, -0.5px letter-spacing, color --text, mt-3)}
         {eventDate && <p> (13px, color --text-sec, mt-1)}
         <div> (accent line: h-[1.5px], mt-4, background gradient transparent -> accent -> transparent)
       </div>
     </header>
     <main> (max-w-[640px] mx-auto px-4 py-6)
       {children}
     </main>
     <footer> (max-w-[640px] mx-auto px-4 py-4, text-center)
       <p> (8px caption, color --text-sec, tracking-wide)
         "C-Sign v1.0"
       </p>
     </footer>
   </div>
   ```

3. **Header gradient background**: Use `theme.headerBg` as the background CSS value on the header element. Add padding: `py-6 sm:py-8`.

4. **Props interface**:
   ```typescript
   interface PublicPageLayoutProps {
     children: React.ReactNode
     eventTitle?: string
     eventDate?: string
     headerRight?: React.ReactNode
   }
   ```

5. **Microinteraction**: Add `transition-colors duration-300` to the outer div for theme switch transitions.

Do NOT apply Inter font here — it's already set by ThemeProvider's wrapper div.
  </action>
  <verify>`cd /workspace/frontend && npx tsc --noEmit` passes.</verify>
  <done>PublicPageLayout renders header with generative gradient, accent line, C-SIGN branding, event title/date, children area at max-w-640px, and footer.</done>
</task>

<task type="auto">
  <name>Task 2: Restyle SignPage, ParticipantForm, SignatureCanvas, and SuccessPage</name>
  <files>
    frontend/src/pages/SignPage.tsx
    frontend/src/pages/SuccessPage.tsx
    frontend/src/components/ParticipantForm.tsx
    frontend/src/components/SignatureCanvas.tsx
  </files>
  <action>
**A. Restyle `SignPage.tsx`:**

1. Import ThemeProvider from `@/contexts/ThemeContext` and PublicPageLayout from `@/components/PublicPageLayout`
2. Extract theme data from the fetched event: `day.event.theme` may contain `{ themeId: "..." }` or `{ customAccent: "#..." }` or be null
3. Wrap the entire page return in `<ThemeProvider themeId={eventTheme?.themeId} customAccent={eventTheme?.customAccent}>`
4. Inside ThemeProvider, use `<PublicPageLayout eventTitle={day?.event.title} eventDate={formattedDate} headerRight={<LanguageSwitcher />}>`
5. Remove the old manually-rendered header (h1, date paragraph, language switcher div)
6. Keep session selection logic, but style the session radio buttons with themed colors:
   - Radio labels: `text-[13px]` (body size), `color: var(--text)`
   - Radio container card: use `style={{ backgroundColor: 'var(--surface)', borderColor: 'var(--border-c)' }}`
7. Loading state: center text with `color: var(--text-sec)` on dark background
8. Error state: use `var(--error)` color instead of hardcoded `text-red-600`
9. Update the AttendanceDay/Event interfaces to include `theme?: { themeId?: string; customAccent?: string } | null`
10. For loading/error states that render before theme data is available, wrap in `<ThemeProvider>` (no props = default tech-modern theme)

**B. Restyle `ParticipantForm.tsx`:**

Apply design system component specs via inline styles using CSS custom properties (NOT Tailwind classes for themed values, since Tailwind v4 @apply is incompatible with CSS variables per project decision 02-01):

1. **Card**: Apply `style={{ backgroundColor: 'var(--surface)', borderColor: 'var(--border-c)' }}` on Card. Remove default card classes that set white background.
2. **CardHeader/CardTitle**: h2 style = `text-[20px] font-bold tracking-[-0.25px]` color `var(--text)`
3. **Form gap**: Change `space-y-4` to `space-y-3.5` (14px per design system)
4. **Labels**: `text-[10px] font-medium tracking-[0.2px] uppercase` color `var(--text-sec)` — wrap in style={{ color: 'var(--text-sec)' }}
5. **Inputs**: `h-9 text-xs rounded-md` with style `{ backgroundColor: 'var(--bg)', color: 'var(--text)', borderColor: 'var(--border-c)' }`. Remove `min-h-[44px]` — h-9 (36px) per design system. Add `focus:ring-1` with accent color via `focus:ring-[var(--accent)] focus:ring-offset-0` (Tailwind v4 supports arbitrary values).
6. **Select trigger**: Same styling as inputs. SelectContent dropdown: `style={{ backgroundColor: 'var(--surface)', borderColor: 'var(--border-c)' }}`. SelectItem: `text-xs cursor-pointer` with hover via accent.
7. **Grid layout**: Wrap Nom/Prenom fields in `<div className="grid grid-cols-1 md:grid-cols-2 gap-2.5">`. Same for Ville/N-pro fields.
8. **Separator before consent**: Add `<div style={{ borderColor: 'var(--border-c)' }} className="border-t my-4" />` before the checkbox.
9. **Checkbox**: style with `data-[state=checked]:bg-[var(--accent)]` if shadcn supports it, otherwise use inline style override.
10. **Consent label**: `text-[11px]` color `var(--text-sec)` leading-snug
11. **Submit button**: `h-10 w-full rounded-lg text-[13px] font-semibold` with `style={{ backgroundColor: 'var(--accent)', color: 'var(--bg)' }}`. Disabled: `opacity-70`. Loading microinteraction: `opacity-70 cursor-wait` when isPending.
12. **Error messages**: Use `var(--error)` color instead of hardcoded `text-red-600`
13. **Global error box**: `style={{ backgroundColor: 'color-mix(in srgb, var(--error) 10%, transparent)', borderColor: 'color-mix(in srgb, var(--error) 30%, transparent)' }}`

**C. Restyle `SignatureCanvas.tsx`:**

1. Canvas container: `rounded-md overflow-hidden` with `style={{ border: '2px solid var(--accent)' }}`. Remove old `border border-border`.
2. Canvas background: keep `backgroundColor="rgb(255, 255, 255)"` (white per design system)
3. Add `cursor: crosshair` to the canvas via canvasProps className
4. Pen stroke: add `penColor="#1a1a2e"` and `minWidth={2.5}` and `maxWidth={2.5}` props to SignatureCanvasLib (for consistent 2.5px line)
5. Placeholder text ("Sign here"): `text-[13px]` color `var(--text-sec)` with low opacity
6. Clear button: style as outline variant: `style={{ borderColor: 'var(--border-c)', color: 'var(--accent)' }}` with `h-7` (28px secondary action per design system)
7. Responsive heights: keep `h-40 sm:h-48 md:h-56`

**D. Restyle `SuccessPage.tsx`:**

1. Import ThemeProvider and PublicPageLayout
2. Wrap in `<ThemeProvider>` (uses default tech-modern since success page may not have event context). NOTE: If the router state could carry theme info, pass it. Otherwise default is fine.
3. Use PublicPageLayout (no eventTitle/eventDate on success)
4. Success icon: replace `<CheckCircle className="w-16 h-16 text-green-600" />` with a circle + checkmark styled per design system:
   - Outer circle: `w-20 h-20 rounded-full` with `style={{ backgroundColor: 'color-mix(in srgb, var(--success) 15%, transparent)', border: '2px solid var(--success)' }}`
   - Inner checkmark: `<CheckCircle style={{ color: 'var(--success)' }} className="w-10 h-10" />`
5. **Success appear microinteraction**: Add CSS animation on the success content:
   - Keyframe: `@keyframes successAppear { from { opacity: 0; transform: scale(0.92); } to { opacity: 1; transform: scale(1); } }`
   - Apply: `animation: successAppear 500ms cubic-bezier(0.34, 1.56, 0.64, 1) forwards` via inline style or a Tailwind `animate-` class defined in index.css
   - Add the keyframe to `frontend/src/index.css` in a `@layer utilities` block
6. Title "Merci !": `text-[30px] font-bold tracking-[-0.5px]` color `var(--text)` (h1 scale)
7. Message: `text-[13px]` color `var(--text-sec)`
8. Remove the Card wrapper — success screen is open layout per design system wireframe (no card, just centered content)
9. "Nouvelle signature" button: outline style with accent border, accent text color

**Important:** When applying styles, prefer inline `style` for CSS custom property values (var(--xxx)) and Tailwind classes for non-themed properties (spacing, layout, responsive). This follows the project pattern of avoiding @apply with CSS variables (decision 02-01).
  </action>
  <verify>
1. `cd /workspace/frontend && npx tsc --noEmit` — no type errors
2. Visually check by grepping: no remaining `text-red-600` or `text-green-600` hardcoded colors in the 4 modified files (they should use var(--error)/var(--success))
3. Verify grid layout: `grep -n "grid-cols-2" frontend/src/components/ParticipantForm.tsx` shows the 2-col desktop grid
  </verify>
  <done>
All public pages render with dark-mode design system styling:
- SignPage wraps in ThemeProvider with event's theme, uses PublicPageLayout header
- ParticipantForm has dark card, themed inputs with accent focus, 2-col grid, design system typography
- SignatureCanvas has white bg, 2px accent border, crosshair cursor, #1a1a2e stroke at 2.5px
- SuccessPage has animated checkmark with --success color, themed layout, no card wrapper
- All colors use CSS custom properties (no hardcoded colors)
- Typography follows Inter scale (h1: 30px, body: 13px, label: 10px)
- Content max-width is 640px
  </done>
</task>

</tasks>

<verification>
1. All 5 files compile without TypeScript errors
2. No hardcoded color values (red-600, green-600, white bg) remain in public page components
3. ParticipantForm has 2-column grid for nom/prenom and ville/n-pro
4. SignatureCanvas uses crosshair cursor and 2px accent border
5. SuccessPage has animation keyframe
6. SignPage reads event.theme and passes to ThemeProvider
</verification>

<success_criteria>
- Public signing page renders with dark background (var(--bg)), themed card (var(--surface)), accent-colored inputs and button
- Header shows generative gradient with event title and accent line
- Form uses 2-col desktop / 1-col mobile grid layout
- Signature canvas has white background, accent border, crosshair cursor
- Success page shows animated checkmark and themed typography
- All themed colors come from CSS custom properties, none hardcoded
</success_criteria>

<output>
After completion, create `.planning/phases/07-ui-design-style-guide-application/07-02-SUMMARY.md`
</output>
