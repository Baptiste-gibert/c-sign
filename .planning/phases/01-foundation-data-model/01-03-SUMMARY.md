---
phase: 01-foundation-data-model
plan: 03
subsystem: seed-data-and-verification
tags: [payload-cms, seed-data, testing, admin-ui]
dependency_graph:
  requires:
    - events-collection
    - attendance-days-collection
    - sessions-collection
    - participants-collection
    - signatures-collection
    - users-collection-with-auth
  provides:
    - seed-data-script
    - rest-api-routes
    - verified-admin-ui
---

## What Was Done

1. **Seed data script** (`backend/src/seed/index.ts`, `run.ts`) — Creates test data via Payload Local API:
   - 1 admin + 2 organizers (Isabelle, Marc)
   - 2 events (3-day non-consecutive + 1-day single)
   - 4 attendance days auto-generated by afterChange hook
   - 3 sessions for Day 1 of Event 1
   - 3 participants with different beneficiary types (veterinaire, pharmacien, autre with "Consultante")
   - Idempotent: skips if admin@ceva.com already exists
   - Accessible via API route: `GET /api/seed`

2. **Payload REST API route** (`backend/src/app/(payload)/api/[...slug]/route.ts`) — Missing catch-all route was preventing all REST API endpoints from working (404 on `/api/users`, `/api/events`, etc.)

3. **Admin UI fixes** — Aligned all `(payload)` files with official Payload 3.x template:
   - Added `import '@payloadcms/next/css'` (entire admin theme was missing)
   - Fixed nested `<html>` tags (root layout now passes children through)
   - Fixed `custom.scss` import path
   - Used function calls instead of JSX for `RootPage`/`NotFoundPage`

## Human Verification

All 8 tests passed — see `.planning/human-tests/01-foundation-data-model.md`:
1. Admin login + 7 collections visible
2. Users list with correct roles
3. Event detail with non-consecutive dates and linked attendance days
4. Attendance days auto-generated correctly (4 total)
5. Sessions linked to Day 1
6. Participant "Autre" with conditional field
7. Organizer scoping (Isabelle sees only her event)
8. Auto-generation hook fires on new event creation

## Decisions

- Seed script runs via API route (`/api/seed`) rather than standalone tsx due to Payload 3.x compatibility
- Payload admin files must match official template exactly — deviations cause CSS/hydration failures

## Issues Found & Fixed

| Issue | Root Cause | Fix |
|-------|-----------|-----|
| REST API 404 on all endpoints | Missing `(payload)/api/[...slug]/route.ts` | Created with Payload REST handlers |
| No CSS/theme in admin UI | Missing `import '@payloadcms/next/css'` | Added to layout |
| Browser hydration errors | Nested `<html>` from root + payload layouts | Root layout returns `children` directly |

## Duration

- Execution: ~15 min (including debugging and fixes)
