---
phase: 09-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/eslint.config.mjs
  - backend/.prettierrc
  - backend/package.json
  - backend/src/**/*.ts
  - backend/src/**/*.tsx
autonomous: true

must_haves:
  truths:
    - "ESLint runs with strict config and produces output (may have errors at this stage)"
    - "Prettier formats all source files with zero formatting violations"
    - "npm run lint, npm run format:check, npm run type-check scripts exist and work"
  artifacts:
    - path: "backend/eslint.config.mjs"
      provides: "ESLint 9 flat config with typescript-eslint strict + Next.js + import sort + Prettier"
      contains: "tseslint.configs.strict"
    - path: "backend/.prettierrc"
      provides: "Prettier config with Tailwind CSS v4 plugin"
      contains: "prettier-plugin-tailwindcss"
    - path: "backend/package.json"
      provides: "Quality scripts (lint, lint:fix, format, format:check, type-check, quality)"
      contains: "\"quality\""
  key_links:
    - from: "backend/eslint.config.mjs"
      to: "eslint-config-prettier/flat"
      via: "import and spread in config array"
      pattern: "eslint-config-prettier"
    - from: "backend/.prettierrc"
      to: "backend/src/app/(frontend)/globals.css"
      via: "tailwindStylesheet option"
      pattern: "tailwindStylesheet"
---

<objective>
Install all code quality dependencies, create ESLint 9 flat config and Prettier config files, add npm scripts, and run Prettier to format the entire codebase to zero formatting violations.

Purpose: Establish the tooling foundation so ESLint and Prettier are configured and all files are consistently formatted before fixing lint errors.
Output: Config files (eslint.config.mjs, .prettierrc), npm scripts, all source files formatted by Prettier.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-code-quality/09-RESEARCH.md
@backend/package.json
@backend/tsconfig.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and create config files</name>
  <files>
    backend/package.json
    backend/eslint.config.mjs
    backend/.prettierrc
  </files>
  <action>
1. Install all dev dependencies in one command:
```bash
cd /workspace/backend && npm install --save-dev @eslint/js typescript-eslint eslint-config-next prettier prettier-plugin-tailwindcss eslint-config-prettier eslint-plugin-simple-import-sort husky lint-staged depcheck
```

2. Create `backend/eslint.config.mjs` with ESLint 9 flat config:
```javascript
import { defineConfig, globalIgnores } from 'eslint/config'
import nextVitals from 'eslint-config-next/core-web-vitals'
import nextTs from 'eslint-config-next/typescript'
import tseslint from 'typescript-eslint'
import prettier from 'eslint-config-prettier/flat'
import simpleImportSort from 'eslint-plugin-simple-import-sort'

const eslintConfig = defineConfig([
  ...tseslint.configs.eslintRecommended,
  ...nextVitals,
  ...nextTs,
  ...tseslint.configs.strict,
  {
    plugins: {
      'simple-import-sort': simpleImportSort,
    },
    rules: {
      'simple-import-sort/imports': 'error',
      'simple-import-sort/exports': 'error',
    },
  },
  prettier,
  globalIgnores([
    '.next/**',
    'out/**',
    'build/**',
    'next-env.d.ts',
    'node_modules/**',
  ]),
])

export default eslintConfig
```

IMPORTANT: Use `eslint-config-prettier/flat` (not `eslint-config-prettier`) for flat config compatibility. Spread all preset arrays with `...` operator. Place Prettier integration LAST before globalIgnores to disable conflicting formatting rules.

3. Create `backend/.prettierrc`:
```json
{
  "semi": false,
  "singleQuote": true,
  "trailingComma": "all",
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "plugins": ["prettier-plugin-tailwindcss"],
  "tailwindStylesheet": "./src/app/(frontend)/globals.css"
}
```

Note: `tailwindStylesheet` points to the actual globals.css location (inside the (frontend) route group). This is required for Tailwind CSS v4.

4. Add scripts to `backend/package.json` (merge into existing scripts):
```json
{
  "lint": "eslint .",
  "lint:fix": "eslint . --fix",
  "format": "prettier --write \"src/**/*.{ts,tsx,js,jsx,json,css}\"",
  "format:check": "prettier --check \"src/**/*.{ts,tsx,js,jsx,json,css}\"",
  "type-check": "tsc --noEmit",
  "quality": "npm run type-check && npm run lint && npm run format:check",
  "depcheck": "depcheck"
}
```

Keep ALL existing scripts (dev, build, start, payload, generate:types, seed). Add the new ones alongside.

5. Verify config loads without errors:
```bash
cd /workspace/backend && npx eslint --print-config src/payload.config.ts > /dev/null 2>&1 && echo "ESLint config OK"
```
  </action>
  <verify>
Run: `cd /workspace/backend && npx eslint --print-config src/payload.config.ts > /dev/null && echo "Config loads"` — should print "Config loads" without errors.
Run: `cd /workspace/backend && npx prettier --check src/payload.config.ts 2>&1 | head -5` — should run without "plugin not found" errors.
  </verify>
  <done>eslint.config.mjs and .prettierrc exist, all npm scripts added, ESLint config loads without parse errors, Prettier recognizes Tailwind plugin.</done>
</task>

<task type="auto">
  <name>Task 2: Format entire codebase with Prettier</name>
  <files>
    backend/src/**/*.ts
    backend/src/**/*.tsx
  </files>
  <action>
1. Run Prettier to format ALL source files:
```bash
cd /workspace/backend && npx prettier --write "src/**/*.{ts,tsx,js,jsx,json,css}"
```

2. Verify zero formatting violations:
```bash
cd /workspace/backend && npx prettier --check "src/**/*.{ts,tsx,js,jsx,json,css}"
```

This must exit 0 with "All matched files use Prettier code style!" or similar.

3. Run TypeScript compilation to ensure formatting changes didn't break types:
```bash
cd /workspace/backend && npx tsc --noEmit
```

IMPORTANT: Prettier only changes formatting (whitespace, quotes, semicolons, trailing commas). It should NEVER change behavior. If tsc fails after formatting, investigate — it likely means a pre-existing type issue, not a Prettier problem.

4. Do NOT manually fix any ESLint errors at this stage. That happens in Plan 02.
  </action>
  <verify>
Run: `cd /workspace/backend && npm run format:check` — must exit 0 with no formatting violations.
Run: `cd /workspace/backend && npm run type-check` — must exit 0 (TypeScript still compiles clean).
  </verify>
  <done>All source files formatted by Prettier. `npm run format:check` exits 0. `npm run type-check` exits 0. Codebase has consistent formatting.</done>
</task>

</tasks>

<verification>
1. `cd /workspace/backend && npm run format:check` exits 0 (zero formatting violations)
2. `cd /workspace/backend && npm run type-check` exits 0 (TypeScript compiles clean)
3. `cd /workspace/backend && npm run lint 2>&1 | tail -3` runs without config errors (lint errors expected at this stage, will be fixed in Plan 02)
4. `backend/eslint.config.mjs` exists with strict config
5. `backend/.prettierrc` exists with Tailwind plugin
</verification>

<success_criteria>
- ESLint 9 flat config with typescript-eslint/strict, Next.js presets, import sorting, and Prettier integration is configured
- Prettier formats all files with zero violations
- TypeScript still compiles clean after formatting
- All quality npm scripts (lint, format, type-check, quality) are available
</success_criteria>

<output>
After completion, create `.planning/phases/09-code-quality/09-01-SUMMARY.md`
</output>
