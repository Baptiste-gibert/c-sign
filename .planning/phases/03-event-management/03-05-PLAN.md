---
phase: 03-event-management
plan: 05
type: execute
wave: 4
depends_on: ["03-03", "03-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Organizer can log in, create event, add participants, open event, view attendance, and finalize"
    - "Full flow from login to event finalization works end-to-end"
    - "All 8 Phase 3 success criteria are met"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete Phase 3 organizer workflow end-to-end: login, create event, manage participants, monitor attendance, and status workflow.

Purpose: Ensure all Phase 3 requirements (EVNT-01, EVNT-03, EVNT-04, EVNT-07, PART-01, PART-02, PART-03, PART-04) work together as a cohesive experience before moving to Phase 4.

Output: Verified working organizer workflow, any bugs fixed, phase ready for completion.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-event-management/03-01-SUMMARY.md
@.planning/phases/03-event-management/03-02-SUMMARY.md
@.planning/phases/03-event-management/03-03-SUMMARY.md
@.planning/phases/03-event-management/03-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start services, seed data, and run automated verification checks</name>
  <files></files>
  <action>
**Step 1: Start backend and frontend**

```bash
cd /workspace/backend && npm run dev &
cd /workspace/frontend && npm run dev &
```

Wait for both to be ready (backend on :3000, frontend on :5173).

**Step 2: Seed test data**

```bash
curl http://localhost:3000/api/seed
```

This creates test users, events, attendance days, sessions, etc.

**Step 3: Automated verification checks**

Run these checks to verify the implementation:

1. **Backend status field**: `curl -s http://localhost:3000/api/events?limit=1 | node -e "const d=require('fs').readFileSync('/dev/stdin','utf8');const j=JSON.parse(d);console.log('status field:', j.docs[0]?.status || 'MISSING')"` -- should show "draft" or a status value

2. **Backend participants field**: `curl -s "http://localhost:3000/api/events?limit=1&depth=1"` -- verify participants field exists in response

3. **Auth endpoint**: `curl -s -X POST http://localhost:3000/api/users/login -H 'Content-Type: application/json' -d '{"email":"admin@csign.dev","password":"admin123"}' -c /tmp/cookies.txt` -- should return user object

4. **Events API with auth**: `curl -s http://localhost:3000/api/events -b /tmp/cookies.txt` -- should return events list

5. **Frontend build**: `cd /workspace/frontend && npx vite build` -- should succeed

6. **TypeScript**: `cd /workspace/frontend && npx tsc --noEmit` -- should pass

7. **Frontend routes**: Verify route configuration exists for /login, /dashboard, /events/new, /events/:id

8. **MSW mock**: Verify frontend/src/mocks/ directory exists with data.ts, handlers.ts, browser.ts

Fix any issues found during automated checks before proceeding to human verification.
  </action>
  <verify>
All 8 automated checks pass. Backend is running. Frontend is running. Seed data exists.
  </verify>
  <done>
Services running, seed data loaded, all automated checks passing. Ready for human verification.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human verification of complete Phase 3 organizer workflow</name>
  <files></files>
  <action>
Present the following verification checklist to the user. This is a checkpoint:human-verify task -- the user must manually test the workflow.

**What was built:** Complete Phase 3 organizer workflow: login, event CRUD, participant management (SIMV search, add/remove, walk-ins), real-time attendance dashboard, status workflow (draft/open/finalized).

**How to verify:**

Pre-requisites: Backend running on :3000, Frontend running on :5173, seed data loaded.

Test 1 - Login Flow:
1. Open http://localhost:5173/login
2. Enter credentials: admin@csign.dev / admin123
3. Verify: redirected to /dashboard after successful login
4. Verify: navigation header shows user name and Deconnexion button

Test 2 - Event List (EVNT-07):
5. On /dashboard, verify: list of events is displayed
6. Verify: each event shows title, location, dates, expense type, and status badge
7. Verify: Nouvel evenement button is visible

Test 3 - Event Creation (EVNT-01, EVNT-03):
8. Click Nouvel evenement button
9. Fill in: title, location (organizer name/email should be pre-filled)
10. Select expense type from dropdown (verify all 6 types present)
11. Select at least 2 dates from calendar
12. Click Creer l'evenement
13. Verify: redirected to event detail page
14. Go back to /dashboard, verify: new event appears in list

Test 4 - Participant Management (PART-01, PART-02, PART-03):
15. On event detail page, find participant search
16. Type a name in the search box
17. Verify: search results appear from mock SIMV registry
18. Select a participant from results
19. Verify: participant appears in the participant table
20. Add 2-3 more participants from search
21. Remove one participant using the remove button
22. Verify: participant removed from table

Test 5 - Walk-In Participant (PART-04):
23. Find walk-in / manual add form
24. Enter: lastName, firstName, email, city, beneficiaryType
25. Click add
26. Verify: walk-in participant appears in participant table

Test 6 - Status Workflow (EVNT-04):
27. Verify event status is Brouillon (draft)
28. Click Ouvrir l'evenement button
29. Verify: status changes to Ouvert (open)
30. Verify: QR codes are visible for attendance days

Test 7 - Attendance Dashboard:
31. With event open, check attendance dashboard section
32. Verify: shows attendance days with sessions
33. Verify: shows 0/N signed
34. Open a QR code URL in a new tab, fill the signing form, submit
35. Return to event detail, verify: attendance dashboard updates to show 1/N signed

Test 8 - Finalize:
36. Click Finaliser l'evenement
37. Verify: status changes to Finalise
38. Verify: add/remove participant controls are disabled

Test 9 - Logout:
39. Click Deconnexion in header
40. Verify: redirected to /login
41. Try navigating to /dashboard directly
42. Verify: redirected back to /login

Resume signal: Type "approved" if all tests pass, or describe any issues found.
  </action>
  <verify>
User confirms all test steps pass or issues are identified and fixed.
  </verify>
  <done>
Human tester confirms all 42 test steps pass. Complete organizer workflow functional from login through event finalization. No blocking bugs. Phase 3 ready for completion.
  </done>
</task>

</tasks>

<verification>
All Phase 3 success criteria verified:
1. Organizer can create event with name, dates, expense type, organizer, location
2. Expense type selection has all 6 options
3. SIMV registry search works by name and registration number
4. Participants can be pre-populated before event
5. Participants can be added and removed
6. Status workflow: draft -> open -> finalized
7. Event list shows past events
8. Real-time attendance dashboard shows who has signed
</verification>

<success_criteria>
Human tester confirms all 42 test steps pass. Complete organizer workflow functional from login through event finalization. No blocking bugs. Phase 3 ready for completion.
</success_criteria>

<output>
After completion, create `.planning/phases/03-event-management/03-05-SUMMARY.md`
</output>
